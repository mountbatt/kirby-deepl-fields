(function(){"use strict";const C="";function c(t,e,n,r,i,u,s,b){var a=typeof t=="function"?t.options:t;e&&(a.render=e,a.staticRenderFns=n,a._compiled=!0),r&&(a.functional=!0),u&&(a._scopeId="data-v-"+u);var l;if(s?(l=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),i&&i.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(s)},a._ssrRegister=l):i&&(l=b?function(){i.call(this,(a.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(a.functional){a._injectStyles=l;var v=a.render;a.render=function(k,d){return l.call(d),v(k,d)}}else{var p=a.beforeCreate;a.beforeCreate=p?[].concat(p,l):[l]}return{exports:t,options:a}}const _={props:{field_name:{type:String,required:!0},page_id:{type:String,required:!0},csrf:{type:String,required:!0},api_key:{type:String,required:!0},api_url:{type:String,required:!0},label:String,endpoints:Object,required:Boolean,disabled:Boolean,inputtype:String,size:String,value:String,selected:String,default:{type:Object,default(){return{name:""}}}},data(){const t=document.querySelector(".k-panel"),e=t.dataset.language,n=t.dataset.translation;return{error:null,button:{base_language:n,current_language:e,text:n+" \u2192 "+e}}},computed:{},methods:{async importOriginalValue(){const t=this.getParentComponent("k-block"),e=await this.$api.get(this.endpoints.model,{language:this.button.base_language});if(t){const n=t.endpoints.field.split("/").at(-1),i=e.content[n].find(u=>u.id===t.id).content[this.field_name];this.$emit("input",i)}else this.$emit("input",e.content[this.field_name])},async doTranslation(t,e){const n=document.querySelector(".k-panel"),r=n.dataset.language,i=n.dataset.translation;if(!t){alert("Error \u2026 No event");return}try{const s=await(await fetch(this.api_url+"?auth_key="+this.api_key+"&preserve_formatting=1split_sentences=1&text="+encodeURIComponent(this.value)+"&target_lang="+r+"&source_lang="+i)).json();console.log(s),this.error=null,this.value=s.translations[0].text,this.$emit("input",s.translations[0].text),s.translations[0].text||(this.error=s.message,console.log(s.message))}catch{}},getParentComponent(t,e=this){let n=null,r=e.$parent;for(;r&&!n;)r.$options.name===t&&(n=r),r=r.$parent;return n},setValue(t){this.error=null,this.$emit("input",t)}}};var g=function(){var e=this,n=e._self._c;return n("k-field",{staticClass:"k-deepl-field",attrs:{required:e.required,disabled:e.disabled,label:e.label}},[n("k-input",{staticClass:"k-deepl-input",attrs:{size:e.size,theme:"field",type:e.inputtype,value:e.value},on:{input:function(r){return e.setValue(r,"value")}}}),n("k-button",{directives:[{name:"show",rawName:"v-show",value:e.button.current_language!=e.button.base_language,expression:"button.current_language != button.base_language"}],staticClass:"k-field-help deepl-button",attrs:{icon:"import",tooltip:e.$t("mountbatt.deepl.importhelp")},on:{click:e.importOriginalValue}},[e._v(e._s(e.$t("mountbatt.deepl.import"))+" \xBB"+e._s(e.button.base_language.toUpperCase())+"\xAB")]),n("k-button",{directives:[{name:"show",rawName:"v-show",value:e.button.current_language!=e.button.base_language,expression:"button.current_language != button.base_language"}],staticClass:"k-field-help deepl-button",attrs:{icon:"refresh",tooltip:e.$t("mountbatt.deepl.translatenow")},on:{click:e.doTranslation}},[e._v(e._s(e.button.text.toUpperCase()))])],1)},f=[],h=c(_,g,f,!1,null,null,null,null);const m=h.exports;panel.plugin("mountbatt/deepl",{fields:{deepl:m}})})();
